<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Village Green Community Darts League</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Clean & modern system font stack -->
  <style>
    :root{
      --bg: #0f1220;
      --card: #151a2e;
      --muted: #8ea0c9;
      --text: #eaf0ff;
      --accent: #6aa6ff;
      --accent-2:#78f0b5;
      --ring:#2b3a6a;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0b0e1a, #0f1220 20%, #0f1220);color:var(--text);font:16px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial}
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}
    header{position:sticky;top:0;z-index:10;background:rgba(15,18,32,.7);backdrop-filter:saturate(140%) blur(8px);border-bottom:1px solid #1e2440}
    .max{max-width:1100px;margin:0 auto;padding:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:36px;height:36px;border-radius:9px;background:linear-gradient(135deg,var(--accent),var(--accent-2));box-shadow:var(--shadow)}
    nav{display:flex;gap:14px;flex-wrap:wrap;margin-top:10px}
    nav a{padding:8px 12px;border:1px solid #21305a;border-radius:999px;color:#cfe0ff}
    nav a:hover{border-color:#3350a8}
    .hero{padding:34px 0 8px}
    h1{font-size:28px;margin:0}
    .sub{color:var(--muted);margin-top:6px}

    section{padding:22px 0}
    .card{background:var(--card);border:1px solid #1e2440;border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}
    h2{margin:0 0 12px 0;font-size:22px}
    .grid{display:grid;gap:16px}
    @media(min-width:900px){ .grid-2{grid-template-columns:1fr 1fr} }

    .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
    .tab, .chip{border:1px solid #22305f;background:#111730;color:#cfe0ff;border-radius:999px;padding:6px 10px;cursor:pointer}
    .tab.active, .chip.active{background:#162046;border-color:#3959be}
    .actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap}

    table{width:100%;border-collapse:collapse;overflow:hidden;border-radius:12px}
    thead th{position:sticky;top:0;background:#121832;border-bottom:1px solid #253064;padding:10px 8px;text-align:left;font-weight:600;color:#d7e5ff}
    tbody td{border-bottom:1px solid #1f274b;padding:10px 8px;color:#e8eeff}
    tbody tr:hover{background:#121832}
    .num{text-align:right}
    .pos{width:2.5ch;text-align:center;color:#a9c0ff}
    .muted{color:var(--muted)}
    .btn{display:inline-block;background:linear-gradient(135deg,#578bff,#78f0b5);color:#0b0e1a;font-weight:700;padding:10px 14px;border-radius:12px;border:0;box-shadow:var(--shadow);cursor:pointer}
    .btn:focus{outline:2px solid var(--ring);outline-offset:2px}
    footer{padding:24px 0;color:#9fb0df}
    .small{font-size:13px;color:#9fb0df}
    .pill{padding:4px 8px;border-radius:999px;background:#1a2244;border:1px solid #2a3a75;color:#c9d8ff;font-size:12px}
    .sr-only{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}
  </style>
</head>
<body>
  <header>
    <div class="max">
      <div class="brand">
        <img class="logo" src="https://villagegreen.coop/wp-content/uploads/2022/08/Logo-base-white-slider.png" alt="Village Green Logo" />
        <div>
          <h1 id="leagueName">Darts League</h1>
          <div class="sub" id="updated"></div>
        </div>
      </div>
      <nav aria-label="Primary">
        <a href="#schedule">Schedule</a>
        <a href="#standings">Standings</a>
        <a href="#report">Report Match</a>
      </nav>
    </div>
  </header>

  <main class="max">
    <!-- SCHEDULE -->
    <section id="schedule">
      <div class="card">
        <h2>Schedule</h2>
        <div id="scheduleTable"></div>
      </div>
    </section>

    <!-- STANDINGS -->
    <section id="standings">
      <div class="card">
        <h2>Standings</h2>
        <div class="toolbar" role="tablist" aria-label="Table type">
          <button class="chip active" id="chip-teams">Teams</button>
          <button class="chip" id="chip-individuals">Individuals</button>
        </div>
        <div class="toolbar" role="tablist" aria-label="Division" id="division-tabs" style="display: none;">
          <button class="tab active" role="tab" aria-selected="true" id="tab-men">Men</button>
          <button class="tab" role="tab" aria-selected="false" id="tab-women">Women</button>
        </div>
        <div>
          <h3 class="muted">Table</h3>
          <div id="standingsTable"></div>
        </div>
      </div>
    </section>

    <!-- REPORT -->
    <section id="report">
      <div class="card">
        <h2>Report Match</h2>
        <div class="actions">
          <a id="reportBtn" class="btn" target="_blank" rel="noopener noreferrer">Open Match Report Form</a>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="max small">Â© <span id="year"></span> <span id="leagueNameFoot">Darts League</span></div>
  </footer>

  <script>
    /* ============================
       EDIT THIS DATA ONLY
       ============================ */
    const TEAMS = {
      t1: "Team 1 - Tall Boyz",
      t2: "Team 2 - Jorkers",
      t3: "Team 3 - Tech Wizards",
      t4: "Team 4 - The Sleepy Queens",
      t5: "Team 5 - New Test",
      t6: "Team 6 - Seal Team Six"
    };

    const IND_MEN = {
      im1: "Drew",
      im2: "Phil",
      im3: "Sev"
    };

    const IND_WOMEN = {
      iw1: "Lee",
      iw2: "Bailey",
      iw3: "Val"
    };

    // Define which players are on which teams
    const TEAM_COMPOSITION = {
      [TEAMS.t1]: [IND_MEN.im1], // Tall Boyz: Drew
      [TEAMS.t2]: [IND_MEN.im2, IND_WOMEN.iw2], // Jorkers: Phil, Bailey  
      [TEAMS.t3]: [IND_MEN.im3, IND_WOMEN.iw3], // Tech Wizards: Sev, Val
      [TEAMS.t4]: [IND_WOMEN.iw1], // The Sleepy Queens: Lee
      [TEAMS.t5]: [], // New Test: (empty for now)
      [TEAMS.t6]: []  // Seal Team Six: (empty for now)
    };

    const DATA = {
      leagueName: "Village Green Community Darts League",
      formUrl: "https://docs.google.com/forms/d/e/1FAIpQLSeDM6h3XBQ-DcwXTZ3vOPA8wvVvvdRG4rrpqJH_kt1MTEulTw/viewform?usp=header"
    };

    const SETTINGS = { venue: "Village Green Community Centre", time: "19:00" };

    // 1) Define nights with pairings
    const NIGHTS = [
      { date: "2025-09-05", matches: [ [TEAMS.t1,TEAMS.t2], [TEAMS.t3,TEAMS.t4] ] },
      { date: "2025-09-12", matches: [ [TEAMS.t1,TEAMS.t3], [TEAMS.t2,TEAMS.t4] ] },
      { date: "2025-09-19", matches: [ [TEAMS.t1,TEAMS.t4], [TEAMS.t2,TEAMS.t3] ] },
    ];

    /* ====== RENDERING LOGIC (no need to edit) ====== */
    const $ = sel => document.querySelector(sel);

    // Function to generate standings data for all players and teams
    function generateStandingsData() {
      const standings = {
        men: { teams: [], individuals: [] },
        women: { teams: [], individuals: [] }
      };

      // All teams are mixed - generate team standings for all teams
      Object.values(TEAMS).forEach((teamName, index) => {
        const teamData = {
          name: teamName,
          P: 3, W: Math.floor(Math.random() * 4), D: Math.floor(Math.random() * 2), L: Math.floor(Math.random() * 4),
          LF: Math.floor(Math.random() * 30) + 10, LA: Math.floor(Math.random() * 30) + 10, Pts: Math.floor(Math.random() * 12)
        };
        
        // Add to both men's and women's team standings (same teams, different stats)
        standings.men.teams.push({...teamData});
        standings.women.teams.push({...teamData});
      });

      // Generate individual standings using TEAM_COMPOSITION mapping
      Object.entries(TEAM_COMPOSITION).forEach(([teamName, playerKeys]) => {
        playerKeys.forEach(playerKey => {
          // Find if this player is male or female
          const isMale = Object.values(IND_MEN).includes(playerKey);
          const isFemale = Object.values(IND_WOMEN).includes(playerKey);
          
          if (isMale) {
            standings.men.individuals.push({
              player: playerKey,
              team: teamName,
              P: 6, W: Math.floor(Math.random() * 7), L: Math.floor(Math.random() * 7),
              LF: Math.floor(Math.random() * 20) + 5, LA: Math.floor(Math.random() * 20) + 5, Pts: Math.floor(Math.random() * 7)
            });
          } else if (isFemale) {
            standings.women.individuals.push({
              player: playerKey,
              team: teamName,
              P: 6, W: Math.floor(Math.random() * 7), L: Math.floor(Math.random() * 7),
              LF: Math.floor(Math.random() * 20) + 5, LA: Math.floor(Math.random() * 20) + 5, Pts: Math.floor(Math.random() * 7)
            });
          }
        });
      });

      return standings;
    }

    // Override DATA.standings with generated data
    DATA.standings = generateStandingsData();

    const autoSchedule = NIGHTS.flatMap(n =>
      n.matches.map(([a,b]) => ({
        date: n.date,
        time: SETTINGS.time,
        vs: [a,b],
        venue: SETTINGS.venue
      }))
    );

    function fmtDate(iso){
      const d = new Date(iso + "T00:00:00");
      return d.toLocaleDateString(undefined, {year:'numeric', month:'short', day:'numeric'});
    }

         function scheduleTable(nights){
       const sorted = [...nights].sort((a,b)=> a.date.localeCompare(b.date));
       let html = `<table aria-label="Schedule"><thead><tr>
         <th>Date</th><th>Time</th><th>Matchup</th><th>Venue</th></tr></thead><tbody>`;
       for (const n of sorted){
         const time  = n.time  || SETTINGS.time;
         const venue = n.venue || SETTINGS.venue || "";
         const matchups = n.matches
           .map(([a,b]) => {
             // Split team names by hyphen and take the part after it
             const teamA = a.split(' - ')[1] || a;
             const teamB = b.split(' - ')[1] || b;
             return `${teamA} <span class="muted">vs</span> ${teamB}`;
           })
           .join(` <span class="muted">||</span> `);
         html += `<tr>
           <td>${fmtDate(n.date)}</td>
           <td>${time}</td>
           <td>${matchups}</td>
           <td>${venue}</td>
         </tr>`;
       }
       html += `</tbody></table>`;
       return html;
     }

    function computeDiff(item){
      const diff = (item.LF ?? 0) - (item.LA ?? 0);
      return diff;
    }

    function standingsTable(items, type){
      // Sort: Points desc -> Diff desc -> Name/Player asc
      const sorted = [...items].sort((a,b)=>{
        const diffA = computeDiff(a), diffB = computeDiff(b);
        if ((b.Pts ?? 0) !== (a.Pts ?? 0)) return (b.Pts ?? 0) - (a.Pts ?? 0);
        if (diffB !== diffA) return diffB - diffA;
        const keyA = (type==="teams" ? a.name : a.player) || "";
        const keyB = (type==="teams" ? b.name : b.player) || "";
        return keyA.localeCompare(keyB);
      });

      let head, rows;
      if(type==="teams"){
        head = `<tr><th>Ranking</th><th>Team</th><th class="num">P</th><th class="num">W</th><th class="num">D</th><th class="num">L</th><th class="num">LF</th><th class="num">LA</th><th class="num">Diff</th><th class="num">Pts</th></tr>`;
        rows = sorted.map((t,i)=>`
          <tr>
            <td class="pos">${i+1}</td>
            <td>${t.name}</td>
            <td class="num">${t.P??0}</td><td class="num">${t.W??0}</td><td class="num">${t.D??0}</td><td class="num">${t.L??0}</td>
            <td class="num">${t.LF??0}</td><td class="num">${t.LA??0}</td>
            <td class="num">${computeDiff(t)}</td>
            <td class="num"><strong>${t.Pts??0}</strong></td>
          </tr>`).join("");
      }else{
        head = `<tr><th>#</th><th>Player</th><th>Team</th><th class="num">P</th><th class="num">W</th><th class="num">L</th><th class="num">LF</th><th class="num">LA</th><th class="num">Diff</th><th class="num">Pts</th></tr>`;
        rows = sorted.map((p,i)=>`
          <tr>
            <td class="pos">${i+1}</td>
            <td>${p.player}</td><td>${p.team||""}</td>
            <td class="num">${p.P??0}</td><td class="num">${p.W??0}</td><td class="num">${p.L??0}</td>
            <td class="num">${p.LF??0}</td><td class="num">${p.LA??0}</td>
            <td class="num">${computeDiff(p)}</td>
            <td class="num"><strong>${p.Pts??0}</strong></td>
          </tr>`).join("");
      }

      return `<table><thead>${head}</thead><tbody>${rows}</tbody></table>`;
    }

    function setActive(btns, active){
      btns.forEach(b=>b.classList.toggle("active", b===active));
    }

    function render(){
      $("#leagueName").textContent = "ðŸŽ¯ " + DATA.leagueName + " ðŸŽ¯";
      $("#leagueNameFoot").textContent = DATA.leagueName;
      $("#updated").textContent = "Updated " + new Date().toLocaleString();
      $("#year").textContent = new Date().getFullYear();
      $("#reportBtn").href = DATA.formUrl || "#";

      // Schedule
      $("#scheduleTable").innerHTML = scheduleTable(NIGHTS);

      // Standings (tabs)
      const tabMen = $("#tab-men"), tabWomen = $("#tab-women");
      const chipTeams = $("#chip-teams"), chipInd = $("#chip-individuals");
      const divisionTabs = $("#division-tabs");
      let division = "men";
      let tableType = "teams";

             function refreshStandings(){
         let data;
         if (tableType === "teams") {
           // Show all teams (they're the same for both divisions since teams are mixed)
           data = DATA.standings.men.teams;
         } else {
           // Use individual data from selected division
           data = DATA.standings[division][tableType];
         }
         $("#standingsTable").innerHTML = standingsTable(data, tableType);
       }

      tabMen.addEventListener("click", ()=>{ division="men"; setActive([tabMen,tabWomen], tabMen); refreshStandings(); });
      tabWomen.addEventListener("click", ()=>{ division="women"; setActive([tabMen,tabWomen], tabWomen); refreshStandings(); });
      
      chipTeams.addEventListener("click", ()=>{ 
        tableType="teams"; 
        setActive([chipTeams,chipInd], chipTeams); 
        divisionTabs.style.display = "none"; // Hide division tabs
        refreshStandings(); 
      });
      
      chipInd.addEventListener("click", ()=>{ 
        tableType="individuals"; 
        setActive([chipTeams,chipInd], chipInd); 
        divisionTabs.style.display = "flex"; // Show division tabs
        refreshStandings(); 
      });

      refreshStandings();
    }

    render();
  </script>
</body>
</html>
